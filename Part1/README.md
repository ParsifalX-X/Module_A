### **üöÄ 0. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (30 –º–∏–Ω—É—Ç)**

**üéØ –¶–µ–ª—å**: –°–æ–∑–¥–∞—Ç—å –í–ú –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ç—å —Å–æ–≥–ª–∞—Å–Ω–æ –¢–ó.

1. **üì• –°–∫–∞—á–∞–π—Ç–µ –ü–û**:

   - **Infotecs IDS**: [–£—Å—Ç–∞–Ω–æ–≤—â–∏–∫](https://www.infotecs.ru/) ‚Üí `infotecs-ids-5.0.iso`.
   - **–ë–∞–∑–∞–ª—å—Ç –°–ü–û**: [ISO](https://basealt.ru/) ‚Üí `alt-server-10.iso`.
   - **–ì–∏–ø–µ—Ä–≤–∏–∑–æ—Ä**: [VMware Workstation Pro](https://www.vmware.com/).

2. **üñ•Ô∏è –°–æ–∑–¥–∞–π—Ç–µ –í–ú**:

   - **–ù–∞–∑–≤–∞–Ω–∏—è**: `FW1`, `FW2`, `CHR-1`, `–°1`, `–°2`, `ALD1`, `R1`, `R2`, `AT1`, `AT2`, `A1-A4`.
   - **–°–µ—Ç—å**:
     - **NAT-—Å–µ—Ç—å 1**: `192.168.1.0/24` (–¥–ª—è FW1, CHR-1).
     - **NAT-—Å–µ—Ç—å 2**: `192.168.2.0/24` (–¥–ª—è FW2, –°1).
     - **Internal Network**: `10.0.0.0/24` (–¥–ª—è ALD1, A1-A4).

3. **üîß –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã**:
   - **–î–ª—è FW1**:
     ```bash
     # –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ FW1:
     ip link set eth0 up
     ip addr add 192.168.1.1/24 dev eth0
     ip link set eth1 up
     ip addr add 10.0.0.1/24 dev eth1
     ```
   - **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
     ```bash
     ping 192.168.1.2  # CHR-1 –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å.
     ```

---

### **üî• 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ FW1 (1 —á–∞—Å)**

**üéØ –¶–µ–ª—å**: –ê–∫—Ç–∏–≤–∞—Ü–∏—è, DHCP, –ø–æ–ª–∏—Ç–∏–∫–∏ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞, —Å–Ω—ç–ø—à–æ—Ç.

#### **–®–∞–≥ 1.1: –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (15 –º–∏–Ω)**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä**:

   ```bash
   apt install apache2 -y
   systemctl start apache2
   ```

2. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ—Ä—Ç 443**:

   ```bash
   ufw allow 443/tcp
   systemctl restart ufw
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
   ```bash
   curl -I https://localhost:443  # –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–≤–µ—Ç "200 OK".
   ```
   _–û—à–∏–±–∫–∞_: –ï—Å–ª–∏ –ø–æ—Ä—Ç –∑–∞–∫—Ä—ã—Ç ‚Üí `ufw disable && ufw enable`.

---

#### **–®–∞–≥ 1.2: DHCP-—Å–µ—Ä–≤–µ—Ä (20 –º–∏–Ω)**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `isc-dhcp-server`**:

   ```bash
   apt install isc-dhcp-server -y
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ `/etc/dhcp/dhcpd.conf`**:

   ```conf
   subnet 192.168.1.0 netmask 255.255.255.0 {
     range 192.168.1.100 192.168.1.200;
     option routers 192.168.1.1;
     option domain-name-servers 8.8.8.8;
   }
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª—É–∂–±—É**:

   ```bash
   systemctl restart isc-dhcp-server
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
   - –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –í–ú –∫ —Å–µ—Ç–∏ FW1 ‚Üí `ip addr show eth0` ‚Üí –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∏—Ç—å IP –∏–∑ –ø—É–ª–∞.  
     _–û—à–∏–±–∫–∞_: –ù–µ—Ç –∞—Ä–µ–Ω–¥—ã ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `journalctl -u isc-dhcp-server`.

---

#### **–®–∞–≥ 1.3: –ü–æ–ª–∏—Ç–∏–∫–∏ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞ (15 –º–∏–Ω)**

1. **–†–∞–∑—Ä–µ—à–∏—Ç–µ ICMP**:

   ```bash
   ufw allow proto icmp from 192.168.1.0/24
   ```

2. **–ó–∞–±–ª–æ–∫–∏—Ä—É–π—Ç–µ —Å–æ—Ü—Å–µ—Ç–∏ —á–µ—Ä–µ–∑ iptables**:

   ```bash
   iptables -A OUTPUT -p tcp -d facebook.com -j DROP
   iptables -A OUTPUT -p tcp -d twitter.com -j DROP
   ```

3. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–∞**:

   ```bash
   iptables-save > /etc/iptables/rules.v4
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
   ```bash
   ping 192.168.1.1  # –î–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å.
   curl https://facebook.com  # –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω.
   ```

---

#### **–®–∞–≥ 1.4: –°–Ω—ç–ø—à–æ—Ç (5 –º–∏–Ω)**

1. **–í VMware**:
   - `–ü–ö–ú –Ω–∞ –í–ú ‚Üí –°–Ω—ç–ø—à–æ—Ç ‚Üí –°–æ–∑–¥–∞—Ç—å`.
   - –ù–∞–∑–≤–∞–Ω–∏–µ: `FW1_Base_Config`.

---

### **üî• 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CHR-1 (1 —á–∞—Å)**

**üéØ –¶–µ–ª—å**: NAT, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å SSH, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –±—ç–∫–∞–ø.

#### **–®–∞–≥ 2.1: NAT (20 –º–∏–Ω)**

1. **–í–∫–ª—é—á–∏—Ç–µ IP-—Ñ–æ—Ä–≤–∞—Ä–¥–∏–Ω–≥**:

   ```bash
   sysctl -w net.ipv4.ip_forward=1
   ```

2. **–î–æ–±–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∏–ª–æ iptables**:

   ```bash
   iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
   - –ù–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π –í–ú: `ping 8.8.8.8` ‚Üí –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–≤–µ—Ç.

---

#### **–®–∞–≥ 2.2: SSH (15 –º–∏–Ω)**

1. **–ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç SSH**:

   ```bash
   nano /etc/ssh/sshd_config  # Port 2222
   systemctl restart sshd
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
   ```bash
   ssh user@localhost -p 2222  # –î–æ–ª–∂–µ–Ω –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è.
   ```
   _–û—à–∏–±–∫–∞_: –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí `ufw allow 2222/tcp`.

---

#### **–®–∞–≥ 2.3: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ –≥—Ä—É–ø–ø–∞ (15 –º–∏–Ω)**

1. **–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**:

   ```bash
   useradd -m -s /bin/bash user2
   passwd user2  # –ü–∞—Ä–æ–ª—å: P@ssw0rd_2023!
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ –≥—Ä—É–ø–ø—É `admin`**:

   ```bash
   groupadd admin
   usermod -aG admin user2
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
   ```bash
   groups user2  # –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≥—Ä—É–ø–ø–∞ admin.
   ```

---

#### **–®–∞–≥ 2.4: –ë—ç–∫–∞–ø (10 –º–∏–Ω)**

1. **–°–æ–∑–¥–∞–π—Ç–µ –∞—Ä—Ö–∏–≤**:

   ```bash
   tar -czvf /backup_chr1.tar.gz /etc/ssh /etc/network
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞—Ä–æ–ª—å**:
   ```bash
   openssl rand -base64 12  # –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—ã–≤–æ–¥ –∫–∞–∫ –ø–∞—Ä–æ–ª—å: e.g., "xT9!kL3@qZ#r".
   ```

---

### **üõ†Ô∏è 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ALD1 (1 —á–∞—Å)**

**üéØ –¶–µ–ª—å**: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ ALD, –¥–æ–º–µ–Ω, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ A1-A2.

#### **–®–∞–≥ 3.1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ ALD (20 –º–∏–Ω)**

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç—ã**:

   ```bash
   apt install ald-server ald-client -y
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ –¥–æ–º–µ–Ω**:

   ```bash
   ald-domain-create corp.local
   ```

3. **–î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**:
   ```bash
   ald-user-add admin -p P@ssw0rd! -d corp.local
   ald-user-add user1 -p P@ssw0rd! -d corp.local
   ```

---

#### **–®–∞–≥ 3.2: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ A1/A2 (20 –º–∏–Ω)**

1. **–ù–∞ A1**:

   ```bash
   ald-join corp.local -u admin -p P@ssw0rd!
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
   ```bash
   ald-list-users  # –î–æ–ª–∂–Ω—ã –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è admin –∏ user1.
   ```

---

### **üîê 4. IDS Group (1 —á–∞—Å)**

**üéØ –¶–µ–ª—å**: –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–µ–Ω—Å–æ—Ä–æ–≤, –±–∞–∑—ã —Å–∏–≥–Ω–∞—Ç—É—Ä, TIAS.

#### **–®–∞–≥ 4.1: –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ IDS HS ‚Üî MC (20 –º–∏–Ω)**

1. **–í –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ IDS MC**:

   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ: `https://192.168.1.1:8443`.
   - –õ–æ–≥–∏–Ω: `admin`, –ü–∞—Ä–æ–ª—å: `P@ssw0rd!`.
   - –î–æ–±–∞–≤—å—Ç–µ IDS HS: `IP: 192.168.1.2`, –ü–æ—Ä—Ç: `514`.

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
   - –í —Ä–∞–∑–¥–µ–ª–µ **–°–µ–Ω—Å–æ—Ä—ã** ‚Üí —Å—Ç–∞—Ç—É—Å "Online".

---

#### **–®–∞–≥ 4.2: –ë–∞–∑—ã —Å–∏–≥–Ω–∞—Ç—É—Ä (15 –º–∏–Ω)**

1. **–û–±–Ω–æ–≤–∏—Ç–µ –±–∞–∑—ã**:

   ```bash
   ids-ns --update-signatures
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞**:
   ```bash
   tail -n 50 /var/log/ids-ns.log  # –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–∏—Å–∏ "Signatures updated".
   ```

---

### **üìä 5. –û—Ç—á–µ—Ç (30 –º–∏–Ω)**

**üéØ –¶–µ–ª—å**: –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —à–∞–≥–æ–≤, —Å–∫—Ä–∏–Ω—à–æ—Ç—ã, —Ç–∞–±–ª–∏—Ü–∞ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤.

1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç—á–µ—Ç–∞**:

   - **–¢–∏—Ç—É–ª—å–Ω—ã–π –ª–∏—Å—Ç**: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞, –¥–∞—Ç–∞, –§–ò–û.
   - **–°–∫—Ä–∏–Ω—à–æ—Ç—ã**:
     - –°–Ω—ç–ø—à–æ—Ç—ã –í–ú.
     - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ DHCP (–ø—É–ª –∞–¥—Ä–µ—Å–æ–≤).
     - –ü–æ–ª–∏—Ç–∏–∫–∏ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞.
   - **–¢–∞–±–ª–∏—Ü–∞ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤**:

     | –ö—Ä–∏—Ç–µ—Ä–∏–π                         | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π   |
     | -------------------------------- | ------ | ------------- |
     | FW1: DHCP –Ω–∞—Å—Ç—Ä–æ–µ–Ω               | ‚úÖ –î–∞  | –ü—É–ª: 100-200  |
     | CHR-1: –°–æ–∑–¥–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å user2 | ‚úÖ –î–∞  | –ì—Ä—É–ø–ø–∞: admin |

2. **–¶–∏—Ñ—Ä–æ–≤–∞—è –≥–∏–≥–∏–µ–Ω–∞**:
   - –í—Å–µ –ø–∞—Ä–æ–ª–∏: `openssl rand -base64 12` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `xT9!kL3@qZ#r`).
   - –õ–æ–≥–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `/var/log/`, –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è root.

---

### **‚ùó –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è**

- **–ü—Ä–æ–±–ª–µ–º–∞**: DHCP –Ω–µ —Ä–∞–∑–¥–∞–µ—Ç –∞–¥—Ä–µ—Å–∞.  
  **–†–µ—à–µ–Ω–∏–µ**:

  ```bash
  systemctl status isc-dhcp-server  # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã.
  journalctl -u isc-dhcp-server -n 50  # –ò—â–∏—Ç–µ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö.
  ```

- **–ü—Ä–æ–±–ª–µ–º–∞**: –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.  
  **–†–µ—à–µ–Ω–∏–µ**:
  ```bash
  ufw status  # –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã.
  netstat -tuln | grep 443  # –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç —Å–ª—É—à–∞–µ—Ç—Å—è.
  ```

---
